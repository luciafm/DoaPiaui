<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Login - DoaPiauí</title>
  <link rel="stylesheet" href="css/login.css">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
</head>
<body>
    <!-- HEADER -->
    <header>
        <h1>DoaPiauí</h1>
        <a href="index.html">Voltar à Home</a>
    </header>
    
    <!-- CARD CENTRAL -->
    <main class="container">
        <h2>Login</h2>
        <form id="formLogin" novalidate>
            <label>Email</label>
            <input id="emailLogin" type="email" required>
            
            <label>Senha</label>
            <input id="senhaLogin" type="password" required>
            
            <button class="btn-login" type="submit">Entrar</button>
        </form>
        <p class="link-cadastro">
            Não tem uma conta? <a href="criarConta.html">Criar conta</a>
        </p>
    </main>
    
    <footer>
        <p>© DoaPiauí - 2025</p>
    </footer>
    
    <!-- Scripts -->
    <script type="module" src="../js/app.js"></script>
    <script type="module" src="../js/validacao.js"></script>
    <script>
 document.getElementById("formLogin").addEventListener("submit", async (e) => {
     e.preventDefault(); // evita o form recarregar a página

     const email = document.getElementById("emailLogin").value.trim();
     const senha = document.getElementById("senhaLogin").value.trim();

     if (!email || !senha) {
         Swal.fire("Erro", "Preencha email e senha.", "error");
         return;
     }

     try {
         const resp = await fetch("http://localhost:3000/login", {
             method: "POST",
             headers: { "Content-Type": "application/json" },
             body: JSON.stringify({ email, senha })
         });

         const data = await resp.json();

         if (data.success) {
            window.location.href = "doacoes.html"; 
         } else {
             Swal.fire("Falha no login", data.msg || "Email ou senha incorretos", "error");
         }

     } catch (err) {
         Swal.fire("Erro", "Não foi possível conectar ao servidor.", "error");
         console.log(err);
     }
 });
 </script>
  
</body>
</html>
